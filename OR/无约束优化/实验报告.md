# 基于 Wolfe-Powell 准则的非精确一维步长搜索算法
### ——结合牛顿法实现无约束最优化算法
* PB20000302 陈泽高

### 问题描述
* 实现基于 Wolfe-Powell 准则的非精确一维步长搜索算法，并将其应用于无约束最优化
* 基于非精确一维步长搜索，从牛顿法、拟牛顿类方法 (DFP/BFGS)、共轭梯度法中选择一种算法

### 算法原理
* 无约束优化迭代算法的一般步骤是：
    * 确定搜索方向 $d^{(k)}$，可以采用牛顿法、拟牛顿类方法 (DFP/BFGS)、共轭梯度法等
    * 确定位移步长 $\alpha^{(k)}$，可以采用精确搜索和非精确搜索。
* 顾名思义，精确搜索即在搜索方向上找到使目标函数下降最多的步长 $$\alpha^{(k)} = argmin_{\alpha} f(x^{(k)} + \alpha \ d^{(k)})$$ 非精确搜索只需在搜索区间上找到符合一定条件的步长即停止搜索，这样虽然下降速度可能慢于精确搜索，但是该方法搜索速度快于精确搜索，往往能够提高算法整体效率。
* 本次实验中，采用 Wolfe-Powell 准则作为非精确搜索的停止条件： $$\varphi(\alpha) \le \varphi(0) + \rho \alpha f'(0) $$ $$\varphi'(\alpha) \ge \sigma \varphi'(0)$$ 其中，$\rho \in (0,1/2), \sigma \in (\rho, 1)$ 是固定参数。将 $\varphi(\alpha)$ 视为在 $x=0$ 附近的二次函数， 采用两点插值法进行搜索。具体算法步骤见参考资料（[1],[2],[3]均可）

### 程序调用说明
本次实验包含两组代码和两个 ```.ipynb``` 文件，内容及功能如下：
* ```search.py```: 实现了基于 Wolfe-Powell 准则的非精确一维步长搜索算法，可调用 ```Line_Search``` 类。此外还可以调用 ```_grad()``` 方法对目标函数求梯度
* ```newton.py```: 实现了基于 **牛顿法** 和 **非精确搜索** 的最优化算法，可调用 ```opt``` 类。此外还可以调用 ```_hesse()``` 方法对目标函数求Hesse阵。
* ```test_debug.ipynb```: 算法实现过程中的测试过程，无需查看
* ```test_release.ipynb```: 算法正式的测试流程，记录了本次实验的测试结果，具体内容详见该文件

关于程序输出：
* 方法 ```opt.opt_newtown()``` 返回无约束最优化算法的结果，此外，还会返回算法结束的方式：
    1. 触发停机条件：梯度小于阈值，运行正常
    2. 达到最大迭代次数，注意此时可能未找到最优解
* 最优化算法调用非精确搜索方法 ```Line_Search.WolfePowell()``` 时，可能出现搜索失败等错误，此时程序会输出警告：
    * Warning! One line search might have failed.
遇到该情况**可能**需要调整参数 $\rho$ 和 $\sigma$ 重试

### 测试数据说明
详见附件 ```test_release.ipynb```

### 程序测试结果
详见附件 ```test_release.ipynb```，以下给出测试流程：
1. 构造目标函数（需要有解析式，且在sympy的函数库中）
初始点（必测点 $[0,0,...,0]$，其余任意）
设置参数 $\rho$ 和 $\sigma$ 
2. 依次进行可行性测试，不同维度的Rosenbrock函数测试，不同初始点的测试，不同搜索参数测试。对比搜索结果和用时

### 分析总结
本次实验实现了基于 Wolfe-Powell 准则的非精确一维步长搜索算法，并将其与牛顿法结合，应用于无约束最优化。
* 不同初始点在优化**Rosenbrock函数**时结果略有差距，但不难看出偏差在允许范围内。从零点附近出发，迭代结果的偏差稍大于其他点
* 高维**Rosenbrock函数**在测试时用时较长，偏差也更明显
* 参数 $\rho$ 越大， $\sigma$ 越小，单次搜索结果越精确，但整体优化效率未必提高；相反，有时适当放松搜索参数可以显著提高算法整体效率。
* 本次实现有一些优化空间，例如：减少目标函数维度计算次数、避免目标函数梯度解析式和Hesse阵解析式的重复计算等。目前它们对运算效率影响不大，将来有需要再进行算法流程优化

### 参考资料
 [1] 运筹学课程PPT
 [2] 运筹学课程实验说明PPT
 [3] https://blog.csdn.net/weixin_43761124/article/details/107436454
 (Wolfe非精确一维搜索算法)
 [4] https://blog.csdn.net/ggdhs/article/details/89913421
 (用sympy.diff求初等函数的导数)
 [5] https://blog.csdn.net/qq_51383000/article/details/121801543
 (求给定初值多元函数Hesse矩阵)